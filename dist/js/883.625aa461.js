"use strict";(self["webpackChunkfrontend_ebox_platform"]=self["webpackChunkfrontend_ebox_platform"]||[]).push([[883],{883:function(e,o,a){a.r(o),a.d(o,{default:function(){return P}});var l=a(6768);const r=e=>((0,l.Qi)("data-v-91f97770"),e=e(),(0,l.jt)(),e),d={class:"pt-0 mt-0 pb-10 ml-0 mr-0 min-w-max[100%]"},n={class:"flex justify-between items-center mb-2 bg-gray-50 p-6 rounded-lg shadow-lg"},t=r((()=>(0,l.Lk)("h1",{class:"font-bold lg:text-2xl text-xl text-indigo-900"},"Mantenimiento de Compañias",-1)));function m(e,o,a,r,m,u){const i=(0,l.g2)("DataTable"),s=(0,l.g2)("CreateCompanyForm");return(0,l.uX)(),(0,l.CE)("div",d,[(0,l.Lk)("div",null,[(0,l.Lk)("div",n,[t,(0,l.Lk)("button",{class:"flex items-center justify-center bg-[#ff8c54] text-white font-semibold px-5 py-2 rounded-lg hover:bg-orange-500 shadow-md",onClick:o[0]||(o[0]=(...e)=>r.openCreateForm&&r.openCreateForm(...e))}," Crear + ")]),(0,l.bF)(i),r.isCreateFormVisible?((0,l.uX)(),(0,l.Wv)(s,{key:0,onClose:r.closeCreateForm},null,8,["onClose"])):(0,l.Q3)("",!0)])])}var u=a(144),i=a(2729),s=a(6329),c=a(9669),p=a(5728);function b(e,o,a,r,d,n){const t=(0,l.g2)("EditCompanyForm"),m=(0,l.g2)("SuccessAlert"),u=(0,l.g2)("ErrorAlert"),b=(0,l.g2)("WarningAlert");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.bF)(i.J,{flat:""},{default:(0,l.k6)((()=>[(0,l.bF)(p.W,{modelValue:r.search,"onUpdate:modelValue":o[0]||(o[0]=e=>r.search=e),label:"Buscar","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":""},null,8,["modelValue"]),(0,l.bF)(s.Py,{headers:r.headers,items:r.filteredItems,search:r.search},{["item.actions"]:(0,l.k6)((({item:e})=>[(0,l.bF)(c.w,{small:"",class:"mr-2",onClick:o=>r.openEditForm(e)},{default:(0,l.k6)((()=>[(0,l.eW)(" mdi-pencil ")])),_:2},1032,["onClick"]),(0,l.bF)(c.w,{small:"",color:"red",onClick:o=>r.deleteItem(e)},{default:(0,l.k6)((()=>[(0,l.eW)(" mdi-delete ")])),_:2},1032,["onClick"])])),_:2},1032,["headers","items","search"]),r.isEditFormVisible?((0,l.uX)(),(0,l.Wv)(t,{key:0,master:r.selectedCompany,onClose:r.closeEditForm},null,8,["master","onClose"])):(0,l.Q3)("",!0)])),_:1}),(0,l.bF)(m),(0,l.bF)(u),(0,l.bF)(b)],64)}var f=a(1189);const V="http://147.182.161.84:9000/api/v1";function g(e,o){return f.A.post(`${V}/companies/add`,o,{headers:{Authorization:`Bearer ${e}`}})}function F(e){return f.A.get(`${V}/companies/all`,{headers:{Authorization:`Bearer ${e}`}})}function v(e,o,a){return f.A.put(`${V}/companies/update/${a}`,o,{headers:{Authorization:`Bearer ${e}`}})}function k(e,o){return f.A.delete(`${V}/companies/delete/${o}`,{headers:{Authorization:`Bearer ${e}`}})}var C=a(5129),h=a(6859),y=a(5130),A=a(2807),W=a(1606),U=a(697),w=a(3745),x=a(1772),_=a(1560);const q=e=>((0,l.Qi)("data-v-6b4ac17f"),e=e(),(0,l.jt)(),e),E=q((()=>(0,l.Lk)("span",{class:"text-h5"},"Editar Master",-1)));function D(e,o,a,r,d,n){return(0,l.uX)(),(0,l.Wv)(x.p,{modelValue:r.dialog,"onUpdate:modelValue":o[11]||(o[11]=e=>r.dialog=e),"max-width":"600px",persistent:""},{default:(0,l.k6)((()=>[(0,l.bF)(i.J,null,{default:(0,l.k6)((()=>[(0,l.bF)(W.r,{class:"text-center"},{default:(0,l.k6)((()=>[E])),_:1}),(0,l.bF)(U.O,null,{default:(0,l.k6)((()=>[(0,l.bF)(_.n,{onSubmit:(0,y.D$)(r.submitForm,["prevent"])},{default:(0,l.k6)((()=>[(0,l.bF)(p.W,{modelValue:r.form.name,"onUpdate:modelValue":o[0]||(o[0]=e=>r.form.name=e),label:"Nombre de Compañia","prepend-icon":"mdi-domain",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.username,"onUpdate:modelValue":o[1]||(o[1]=e=>r.form.username=e),label:"Nombre de Usuario","prepend-icon":"mdi-account",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.password,"onUpdate:modelValue":o[2]||(o[2]=e=>r.form.password=e),label:"Contraseña",type:"password","prepend-icon":"mdi-lock",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.code,"onUpdate:modelValue":o[3]||(o[3]=e=>r.form.code=e),label:"Código","prepend-icon":"mdi-file-document-outline",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.ubigeo,"onUpdate:modelValue":o[4]||(o[4]=e=>r.form.ubigeo=e),label:"ubigeo","prepend-icon":"mdi-map-marker",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.address,"onUpdate:modelValue":o[5]||(o[5]=e=>r.form.address=e),label:"address","prepend-icon":"mdi-map-marker",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.email,"onUpdate:modelValue":o[6]||(o[6]=e=>r.form.email=e),label:"email","prepend-icon":"mdi-mail",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.phone,"onUpdate:modelValue":o[7]||(o[7]=e=>r.form.phone=e),label:"Télefono","prepend-icon":"mdi-phone",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.codefiscal,"onUpdate:modelValue":o[8]||(o[8]=e=>r.form.codefiscal=e),label:"Código postal","prepend-icon":"mdi-file-document-outline",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.document,"onUpdate:modelValue":o[9]||(o[9]=e=>r.form.document=e),label:"Documento","prepend-icon":"mdi mdi-account-box-outline",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.logo,"onUpdate:modelValue":o[10]||(o[10]=e=>r.form.logo=e),label:"Logo URL","prepend-icon":"mdi-image",required:""},null,8,["modelValue"]),(0,l.bF)(w.S,{class:"justify-end"},{default:(0,l.k6)((()=>[(0,l.bF)(A.D,{text:"",onClick:r.closeDialog,color:"#180c24"},{default:(0,l.k6)((()=>[(0,l.eW)("Cancelar")])),_:1},8,["onClick"]),(0,l.bF)(A.D,{type:"submit",color:"#ff8c54"},{default:(0,l.k6)((()=>[(0,l.eW)("Guardar")])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}var $={props:{master:{type:Object,required:!0}},emits:["close"],setup(e,{emit:o}){const a=(0,u.KR)(!0),r=(0,u.KR)({username:"",password:"",name:"",ubigeo:"",address:"",email:"",phone:"",codefiscal:"",document:"",logo:""});(0,l.wB)((()=>e.master),(e=>{e&&(r.value={...e})}),{immediate:!0});const d=()=>{o("close")},n=async()=>{try{const e={username:r.value.username,password:r.value.password,name:r.value.name,code:r.value.code,ubigeo:r.value.ubigeo,address:r.value.address,email:r.value.email,phone:r.value.phone,codefiscal:r.value.codefiscal,document:r.value.document,logo:r.value.logo},o=C.A.state.token,a=r.value.companyId;await v(o,e,a),h.A.emit("success","¡Operación completada con éxito!"),h.A.emit("masterCreated"),d()}catch(e){h.A.emit("error",`Ups... hubo un error al editar el usuario:  ${e.message}`),console.error("Error al actualizar el master:",e.message)}};return{dialog:a,form:r,closeDialog:d,submitForm:n}}},L=a(1241);const R=(0,L.A)($,[["render",D],["__scopeId","data-v-6b4ac17f"]]);var K=R,S=a(8372),j=a(7572),I=a(3194),O={name:"DataTable",components:{EditCompanyForm:K,SuccessAlert:S.A,ErrorAlert:j.A,WarningAlert:I.A},setup(){const e=(0,u.KR)(""),o=(0,u.KR)([]),a=C.A.state.token,r=(0,u.KR)(!1),d=(0,u.KR)(null),n=(0,u.KR)([{align:"start",key:"name",sortable:!1,title:"Nombre de Compañia"},{key:"code",title:"code"},{key:"username",title:"Usuario"},{key:"document",title:"Documento",sortable:!1},{key:"actions",title:"Acciones",sortable:!1}]),t=async()=>{try{const e=await F(a);o.value=e.data.data}catch(e){console.error("Error al obtener los companies:",e)}},m=e=>{d.value=e,r.value=!0},i=()=>{r.value=!1};(0,l.sV)((()=>{t(),h.A.on("masterCreated",t)})),(0,l.xo)((()=>{h.A.off("masterCreated",t)}));const s=(0,l.EW)((()=>{if(!e.value)return o.value;const a=e.value.toLowerCase();return o.value.filter((e=>Object.values(e).some((e=>String(e).toLowerCase().includes(a)))))})),c=e=>{const o=e.companyId,a=e.username;h.A.emit("warning",{msg:`¿Estás seguro de que deseas eliminar al usuario ${a}?`,action:async()=>{try{const e=C.A.state.token;await k(e,o),h.A.emit("success","¡Operación completada con éxito!"),t()}catch(e){console.error("Error al eliminar el master:",e)}}})};return{search:e,headers:n,filteredItems:s,openEditForm:m,closeEditForm:i,isEditFormVisible:r,selectedCompany:d,deleteItem:c}}};const B=(0,L.A)(O,[["render",b]]);var X=B;const z=(0,l.Lk)("span",{class:"text-h5 mp-2 mb-4 text-center"},"Crear Nueva Compañia",-1);function N(e,o,a,r,d,n){return(0,l.uX)(),(0,l.Wv)(x.p,{modelValue:r.dialog,"onUpdate:modelValue":o[11]||(o[11]=e=>r.dialog=e),"max-width":"600px",persistent:""},{default:(0,l.k6)((()=>[(0,l.bF)(i.J,null,{default:(0,l.k6)((()=>[z,(0,l.bF)(U.O,null,{default:(0,l.k6)((()=>[(0,l.bF)(_.n,{onSubmit:(0,y.D$)(r.submitForm,["prevent"])},{default:(0,l.k6)((()=>[(0,l.bF)(p.W,{modelValue:r.form.name,"onUpdate:modelValue":o[0]||(o[0]=e=>r.form.name=e),label:"Nombre de la Compañia ","prepend-icon":"mdi-domain",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.username,"onUpdate:modelValue":o[1]||(o[1]=e=>r.form.username=e),label:"Usuario ","prepend-icon":"mdi-account",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.password,"onUpdate:modelValue":o[2]||(o[2]=e=>r.form.password=e),label:"Contraseña",type:"password","prepend-icon":"mdi-lock",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.code,"onUpdate:modelValue":o[3]||(o[3]=e=>r.form.code=e),label:"Código","prepend-icon":"mdi-file-document-outline",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.document,"onUpdate:modelValue":o[4]||(o[4]=e=>r.form.document=e),label:"Documento","prepend-icon":"mdi mdi-account-box-outline",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.ubigeo,"onUpdate:modelValue":o[5]||(o[5]=e=>r.form.ubigeo=e),label:"ubigeo","prepend-icon":"mdi-map-marker",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.address,"onUpdate:modelValue":o[6]||(o[6]=e=>r.form.address=e),label:"Dirección","prepend-icon":"mdi-map-marker",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.email,"onUpdate:modelValue":o[7]||(o[7]=e=>r.form.email=e),label:"Correo","prepend-icon":"mdi-mail",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.phone,"onUpdate:modelValue":o[8]||(o[8]=e=>r.form.phone=e),label:"Teléfono","prepend-icon":"mdi-phone",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.codefiscal,"onUpdate:modelValue":o[9]||(o[9]=e=>r.form.codefiscal=e),label:"Código Fiscal","prepend-icon":"mdi-file-document-outline",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:r.form.logo,"onUpdate:modelValue":o[10]||(o[10]=e=>r.form.logo=e),label:"Logo URL","prepend-icon":"mdi-camera",required:""},null,8,["modelValue"]),(0,l.bF)(w.S,{class:"justify-end"},{default:(0,l.k6)((()=>[(0,l.bF)(A.D,{text:"",onClick:r.closeDialog,color:"#180c24"},{default:(0,l.k6)((()=>[(0,l.eW)("Cancelar")])),_:1},8,["onClick"]),(0,l.bF)(A.D,{type:"submit",color:"#ff8c54"},{default:(0,l.k6)((()=>[(0,l.eW)("Guardar")])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}var T={emits:["close"],setup(e,{emit:o}){const a=(0,u.KR)(!0),l=(0,u.KR)({username:"",password:"",name:"",code:"",logo:"",ubigeo:"",address:"",email:"",phone:"",codefiscal:"",document:""}),r=()=>{o("close")},d=async()=>{const e=C.A.state.token,o={username:l.value.username,password:l.value.password,name:l.value.name,code:l.value.code,logo:l.value.logo,ubigeo:l.value.ubigeo,address:l.value.address,email:l.value.email,phone:l.value.phone,codefiscal:l.value.codefiscal,document:l.value.document};try{await g(e,o),h.A.emit("success","¡Operación completada con éxito!"),h.A.emit("masterCreated"),r()}catch(a){h.A.emit("error",`Ups... hubo un error al crear el usuario:  ${a.message}`)}};return{dialog:a,form:l,closeDialog:r,submitForm:d}}};const Q=(0,L.A)(T,[["render",N]]);var J=Q,G={components:{DataTable:X,CreateCompanyForm:J},setup(){const e=(0,u.KR)(!1),o=()=>{e.value=!0},a=()=>{e.value=!1};return{isCreateFormVisible:e,openCreateForm:o,closeCreateForm:a}}};const M=(0,L.A)(G,[["render",m],["__scopeId","data-v-91f97770"]]);var P=M}}]);
//# sourceMappingURL=883.625aa461.js.map