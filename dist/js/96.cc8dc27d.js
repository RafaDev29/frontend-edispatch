"use strict";(self["webpackChunkfrontend_ebox_platform"]=self["webpackChunkfrontend_ebox_platform"]||[]).push([[96],{1410:function(e,t,a){a.d(t,{GR:function(){return n},L0:function(){return s},a1:function(){return l},nL:function(){return i}});var r=a(1189);const o="http://147.182.161.84:9000/api/v1";function l(e){return r.A.get(`${o}/cisterns/all`,{headers:{Authorization:`Bearer ${e}`}})}function n(e,t){return r.A.post(`${o}/cisterns/add`,t,{headers:{Authorization:`Bearer ${e}`}})}function s(e,t){return r.A.delete(`${o}/cisterns/delete/${t}`,{headers:{Authorization:`Bearer ${e}`}})}function i(e,t,a){return console.log(a),r.A.put(`${o}/cisterns/update/${a}`,t,{headers:{Authorization:`Bearer ${e}`}})}},9096:function(e,t,a){a.r(t),a.d(t,{default:function(){return Y}});var r=a(6768);const o=e=>((0,r.Qi)("data-v-4d36ed90"),e=e(),(0,r.jt)(),e),l={class:"pt-0 mt-0 pb-10 ml-0 mr-0 min-w-max[100%]"},n={class:"flex justify-between items-center mb-2 bg-gray-50 p-6 rounded-lg shadow-lg"},s=o((()=>(0,r.Lk)("h1",{class:"font-bold lg:text-2xl text-xl text-indigo-900"},[(0,r.Lk)("span",{class:"mdi mdi-barrel"}),(0,r.eW)(" Mantenimiento de Cargas")],-1)));function i(e,t,a,o,i,d){const u=(0,r.g2)("DataTable"),c=(0,r.g2)("CreateLoadForm");return(0,r.uX)(),(0,r.CE)("div",l,[(0,r.Lk)("div",null,[(0,r.Lk)("div",n,[s,(0,r.Lk)("button",{class:"flex items-center justify-center bg-[#ff8c54] text-white font-semibold px-5 py-2 rounded-lg hover:bg-orange-500 shadow-md",onClick:t[0]||(t[0]=(...e)=>o.openCreateForm&&o.openCreateForm(...e))}," Crear + ")]),(0,r.bF)(u),o.isCreateFormVisible?((0,r.uX)(),(0,r.Wv)(c,{key:0,onClose:o.closeCreateForm},null,8,["onClose"])):(0,r.Q3)("",!0)])])}var d=a(144),u=a(2729),c=a(6329),m=a(9669),p=a(5728);function f(e,t,a,o,l,n){const s=(0,r.g2)("EditLoadForm"),i=(0,r.g2)("SuccessAlert"),d=(0,r.g2)("ErrorAlert"),f=(0,r.g2)("WarningAlert");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.bF)(u.J,{flat:""},{default:(0,r.k6)((()=>[(0,r.bF)(p.W,{modelValue:o.search,"onUpdate:modelValue":t[0]||(t[0]=e=>o.search=e),label:"Buscar","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":"",density:"compact"},null,8,["modelValue"]),(0,r.bF)(c.Py,{headers:o.headers,items:o.filteredItems,search:o.search},{["item.actions"]:(0,r.k6)((({item:e})=>[(0,r.bF)(m.w,{small:"",class:"mr-2",onClick:t=>o.openEditForm(e)},{default:(0,r.k6)((()=>[(0,r.eW)(" mdi-pencil ")])),_:2},1032,["onClick"]),(0,r.bF)(m.w,{small:"",color:"red",onClick:t=>o.deleteItem(e)},{default:(0,r.k6)((()=>[(0,r.eW)(" mdi-delete ")])),_:2},1032,["onClick"])])),_:2},1032,["headers","items","search"]),o.isEditFormVisible?((0,r.uX)(),(0,r.Wv)(s,{key:0,cisterns:o.selectCisterns,onClose:o.closeEditForm},null,8,["cisterns","onClose"])):(0,r.Q3)("",!0)])),_:1}),(0,r.bF)(i),(0,r.bF)(d),(0,r.bF)(f)],64)}var b=a(1189);const g="http://147.182.161.84:9000/api/v1";function v(e){return b.A.get(`${g}/loads/all`,{headers:{Authorization:`Bearer ${e}`}})}function h(e,t){return b.A.post(`${g}/loads/add`,t,{headers:{Authorization:`Bearer ${e}`}})}function C(e,t,a){return console.log(a),b.A.put(`${g}/loads/update/${a}`,t,{headers:{Authorization:`Bearer ${e}`}})}function F(e,t){return b.A.delete(`${g}/loads/delete/${t}`,{headers:{Authorization:`Bearer ${e}`}})}var k=a(5129),A=a(6859),y=a(5130),V=a(2807),_=a(1606),$=a(697),x=a(3745),w=a(1772),E=a(1560),I=a(5249);const W=e=>((0,r.Qi)("data-v-6ef76a30"),e=e(),(0,r.jt)(),e),K=W((()=>(0,r.Lk)("span",{class:"text-h5"},"Editar carga",-1)));function R(e,t,a,o,l,n){return(0,r.uX)(),(0,r.Wv)(w.p,{modelValue:o.dialog,"onUpdate:modelValue":t[3]||(t[3]=e=>o.dialog=e),"max-width":"600px",persistent:""},{default:(0,r.k6)((()=>[(0,r.bF)(u.J,null,{default:(0,r.k6)((()=>[(0,r.bF)(_.r,{class:"text-center"},{default:(0,r.k6)((()=>[K])),_:1}),(0,r.bF)($.O,null,{default:(0,r.k6)((()=>[(0,r.bF)(E.n,{onSubmit:(0,y.D$)(o.submitForm,["prevent"])},{default:(0,r.k6)((()=>[(0,r.bF)(p.W,{modelValue:o.form.amount,"onUpdate:modelValue":t[0]||(t[0]=e=>o.form.amount=e),label:"Cantidad",type:"number","prepend-icon":"mdi mdi-fuel",required:""},null,8,["modelValue"]),(0,r.bF)(p.W,{modelValue:o.form.date,"onUpdate:modelValue":t[1]||(t[1]=e=>o.form.date=e),label:"Fecha",type:"date","prepend-icon":"mdi mdi-calendar-range",required:""},null,8,["modelValue"]),(0,r.bF)(I.d4,{modelValue:o.selectedCustomerName,"onUpdate:modelValue":t[2]||(t[2]=e=>o.selectedCustomerName=e),items:o.customerNames,"prepend-icon":"mdi mdi-account-group",required:""},null,8,["modelValue","items"]),(0,r.bF)(x.S,{class:"justify-end"},{default:(0,r.k6)((()=>[(0,r.bF)(V.D,{text:"",onClick:o.closeDialog,color:"#180c24"},{default:(0,r.k6)((()=>[(0,r.eW)("Cancelar")])),_:1},8,["onClick"]),(0,r.bF)(V.D,{type:"submit",color:"#ff8c54"},{default:(0,r.k6)((()=>[(0,r.eW)("Guardar")])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}var L=a(1410),N={props:{cisterns:{type:Object,required:!0}},emits:["close"],setup(e,{emit:t}){const a=(0,d.KR)([]),o=(0,d.KR)([]),l=(0,d.KR)(e.cisterns.cisternName),n=(0,d.KR)(!0),s=(0,d.KR)({amount:"",cisternId:"",date:""});(0,r.wB)((()=>e.cisterns),(e=>{e&&(s.value={...e})}),{immediate:!0});const i=()=>{t("close")},u=async()=>{const e=a.value.find((e=>e.plate===l.value));if(e){s.value.cisternId=e.cisternId;try{const e={gallons:s.value.gallons,date:s.value.date,cisternId:s.value.cisternId,image:s.value.image},t=k.A.state.token,a=s.value.loadId;await C(t,e,a),A.A.emit("success","¡Operación completada con éxito!"),A.A.emit("masterCreated"),i()}catch(t){A.A.emit("error",`Ups... hubo un error al editar el usuario:  ${t.message}`),console.error("Error al actualizar el cisterns:",t.message)}}else A.A.emit("error","No se encontró el cliente seleccionado")},c=async()=>{const e=k.A.state.token;try{const t=await(0,L.a1)(e);a.value=t.data.data,o.value=a.value.map((e=>e.plate))}catch(t){A.A.emit("error",`Error al cargar los clientes: ${t.message}`)}};return(0,r.sV)((()=>{c()})),{dialog:n,form:s,closeDialog:i,submitForm:u,selectedCustomerName:l,customerNames:o,fetchCustomers:c}}},D=a(1241);const U=(0,D.A)(N,[["render",R],["__scopeId","data-v-6ef76a30"]]);var B=U,z=a(8372),S=a(7572),j=a(3194),q={name:"DataTable",components:{EditLoadForm:B,SuccessAlert:z.A,ErrorAlert:S.A,WarningAlert:j.A},setup(){const e=(0,d.KR)(""),t=(0,d.KR)([]),a=k.A.state.token,o=(0,d.KR)(!1),l=(0,d.KR)(null),n=(0,d.KR)([{key:"date",title:"Fecha de la carga",align:"center"},{key:"cisternName",title:"Cisterna",align:"center"},{key:"amount",title:"Cantidad",align:"center"},{key:"actions",title:"Acciones",sortable:!1}]),s=async()=>{try{const e=await v(a);t.value=e.data.data}catch(e){console.error("Error al obtener los cisterns:",e)}},i=e=>{l.value=e,o.value=!0},u=()=>{o.value=!1};(0,r.sV)((()=>{s(),A.A.on("masterCreated",s)})),(0,r.xo)((()=>{A.A.off("masterCreated",s)}));const c=(0,r.EW)((()=>{if(!e.value)return t.value;const a=e.value.toLowerCase();return t.value.filter((e=>Object.values(e).some((e=>String(e).toLowerCase().includes(a)))))})),m=e=>{const t=e.loadId,a=e.username;A.A.emit("warning",{msg:`¿Estás seguro de que deseas eliminar al usuario ${a}?`,action:async()=>{try{const e=k.A.state.token;await F(e,t),A.A.emit("success","¡Operación completada con éxito!"),s()}catch(e){console.error("Error al eliminar el cisterns:",e)}}})};return{search:e,headers:n,filteredItems:c,openEditForm:i,closeEditForm:u,isEditFormVisible:o,selectCisterns:l,deleteItem:m}}};const O=(0,D.A)(q,[["render",f],["__scopeId","data-v-3389400a"]]);var X=O;const Q=(0,r.Lk)("span",{class:"text-h5 mp-2 mb-4 text-center"},"Crear Nueva Carga",-1);function G(e,t,a,o,l,n){return(0,r.uX)(),(0,r.Wv)(w.p,{modelValue:o.dialog,"onUpdate:modelValue":t[3]||(t[3]=e=>o.dialog=e),"max-width":"600px",persistent:""},{default:(0,r.k6)((()=>[(0,r.bF)(u.J,null,{default:(0,r.k6)((()=>[Q,(0,r.bF)($.O,null,{default:(0,r.k6)((()=>[(0,r.bF)(E.n,{onSubmit:(0,y.D$)(o.submitForm,["prevent"])},{default:(0,r.k6)((()=>[(0,r.bF)(p.W,{modelValue:o.form.amount,"onUpdate:modelValue":t[0]||(t[0]=e=>o.form.amount=e),label:"Cantidad",type:"number","prepend-icon":"mdi mdi-fuel",required:""},null,8,["modelValue"]),(0,r.bF)(p.W,{modelValue:o.form.date,"onUpdate:modelValue":t[1]||(t[1]=e=>o.form.date=e),label:"Fecha",type:"date","prepend-icon":"mdi mdi-calendar-range",required:""},null,8,["modelValue"]),(0,r.bF)(I.d4,{modelValue:o.selectedCustomerName,"onUpdate:modelValue":t[2]||(t[2]=e=>o.selectedCustomerName=e),items:o.customerNames,label:"Cliente","prepend-icon":"mdi mdi-account-group",required:""},null,8,["modelValue","items"]),(0,r.bF)(x.S,{class:"justify-end"},{default:(0,r.k6)((()=>[(0,r.bF)(V.D,{text:"",onClick:o.closeDialog,color:"#180c24"},{default:(0,r.k6)((()=>[(0,r.eW)("Cancelar")])),_:1},8,["onClick"]),(0,r.bF)(V.D,{type:"submit",color:"#ff8c54"},{default:(0,r.k6)((()=>[(0,r.eW)("Guardar")])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}var J={emits:["close"],setup(e,{emit:t}){const a=(0,d.KR)(""),o=(0,d.KR)([]),l=(0,d.KR)([]),n=(0,d.KR)(!0),s=(0,d.KR)({gallons:"",image:"",cisternId:""}),i=async()=>{const e=k.A.state.token;try{const t=await(0,L.a1)(e);l.value=t.data.data,o.value=l.value.map((e=>e.plate))}catch(t){A.A.emit("error",`Error al cargar los clientes: ${t.message}`)}},u=()=>{t("close")},c=async()=>{const e=l.value.find((e=>e.plate===a.value));if(!e)return void A.A.emit("error","No se encontró el cliente seleccionado");s.value.cisternId=e.cisternId;const t=k.A.state.token,r={amount:s.value.amount,date:s.value.date,cisternId:s.value.cisternId,image:s.value.image};try{await h(t,r),A.A.emit("success","¡Operación completada con éxito!"),A.A.emit("masterCreated"),u()}catch(o){A.A.emit("error",`Ups... hubo un error al crear el usuario:  ${o.message}`)}};return(0,r.sV)((()=>{i()})),{dialog:n,form:s,closeDialog:u,submitForm:c,selectedCustomerName:a,customerNames:o,fetchCustomers:i}}};const T=(0,D.A)(J,[["render",G]]);var M=T,P={components:{DataTable:X,CreateLoadForm:M},setup(){const e=(0,d.KR)(!1),t=()=>{e.value=!0},a=()=>{e.value=!1};return{isCreateFormVisible:e,openCreateForm:t,closeCreateForm:a}}};const H=(0,D.A)(P,[["render",i],["__scopeId","data-v-4d36ed90"]]);var Y=H}}]);
//# sourceMappingURL=96.cc8dc27d.js.map