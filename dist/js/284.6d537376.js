"use strict";(self["webpackChunkfrontend_ebox_platform"]=self["webpackChunkfrontend_ebox_platform"]||[]).push([[284],{284:function(e,a,r){r.r(a),r.d(a,{default:function(){return P}});var l=r(6768);const t=e=>((0,l.Qi)("data-v-403e9892"),e=e(),(0,l.jt)(),e),o={class:"pt-0 mt-0 pb-10 ml-0 mr-0 min-w-max[100%]"},n={class:"flex justify-between items-center mb-2 bg-gray-50 p-6 rounded-lg shadow-lg"},s=t((()=>(0,l.Lk)("h1",{class:"font-bold lg:text-2xl text-xl text-indigo-900"},[(0,l.Lk)("span",{class:"mdi mdi-steering"}),(0,l.eW)(" Mantenimiento de Conductores ")],-1)));function i(e,a,r,t,i,u){const d=(0,l.g2)("DataTable"),m=(0,l.g2)("CreateDriversForm");return(0,l.uX)(),(0,l.CE)("div",o,[(0,l.Lk)("div",null,[(0,l.Lk)("div",n,[s,(0,l.Lk)("button",{class:"flex items-center justify-center bg-[#ff8c54] text-white font-semibold px-5 py-2 rounded-lg hover:bg-orange-500 shadow-md",onClick:a[0]||(a[0]=(...e)=>t.openCreateForm&&t.openCreateForm(...e))}," Crear + ")]),(0,l.bF)(d),t.isCreateFormVisible?((0,l.uX)(),(0,l.Wv)(m,{key:0,onClose:t.closeCreateForm},null,8,["onClose"])):(0,l.Q3)("",!0)])])}var u=r(144),d=r(2729),m=r(6329),c=r(9669),p=r(5728);function b(e,a,r,t,o,n){const s=(0,l.g2)("EditDriverForm"),i=(0,l.g2)("SuccessAlert"),u=(0,l.g2)("ErrorAlert"),b=(0,l.g2)("WarningAlert");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.bF)(d.J,{flat:""},{default:(0,l.k6)((()=>[(0,l.bF)(p.W,{modelValue:t.search,"onUpdate:modelValue":a[0]||(a[0]=e=>t.search=e),label:"Buscar","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":"",density:"compact"},null,8,["modelValue"]),(0,l.bF)(m.Py,{headers:t.headers,items:t.filteredItems,search:t.search},{["item.actions"]:(0,l.k6)((({item:e})=>[(0,l.bF)(c.w,{small:"",class:"mr-2",onClick:a=>t.openEditForm(e)},{default:(0,l.k6)((()=>[(0,l.eW)(" mdi-pencil ")])),_:2},1032,["onClick"]),(0,l.bF)(c.w,{small:"",color:"red",onClick:a=>t.deleteItem(e)},{default:(0,l.k6)((()=>[(0,l.eW)(" mdi-delete ")])),_:2},1032,["onClick"])])),_:2},1032,["headers","items","search"]),t.isEditFormVisible?((0,l.uX)(),(0,l.Wv)(s,{key:0,cisterns:t.selectCisterns,onClose:t.closeEditForm},null,8,["cisterns","onClose"])):(0,l.Q3)("",!0)])),_:1}),(0,l.bF)(i),(0,l.bF)(u),(0,l.bF)(b)],64)}var f=r(1189);const v="http://147.182.161.84:9000/api/v1";function F(e){return f.A.get(`${v}/drivers/all`,{headers:{Authorization:`Bearer ${e}`}})}function k(e,a,r){return console.log(r),f.A.put(`${v}/drivers/update/${r}`,a,{headers:{Authorization:`Bearer ${e}`}})}function V(e,a){return f.A.delete(`${v}/drivers/delete/${a}`,{headers:{Authorization:`Bearer ${e}`}})}function C(e,a){return f.A.post(`${v}/drivers/add`,a,{headers:{Authorization:`Bearer ${e}`}})}var g=r(5129),A=r(6859),h=r(5130),w=r(2807),y=r(1606),x=r(697),_=r(3745),N=r(1772),W=r(1560);const U=e=>((0,l.Qi)("data-v-1ac92ec6"),e=e(),(0,l.jt)(),e),D=U((()=>(0,l.Lk)("span",{class:"text-h5"},"Editar Conductor",-1)));function E(e,a,r,t,o,n){return(0,l.uX)(),(0,l.Wv)(N.p,{modelValue:t.dialog,"onUpdate:modelValue":a[5]||(a[5]=e=>t.dialog=e),"max-width":"600px",persistent:""},{default:(0,l.k6)((()=>[(0,l.bF)(d.J,null,{default:(0,l.k6)((()=>[(0,l.bF)(y.r,{class:"text-center"},{default:(0,l.k6)((()=>[D])),_:1}),(0,l.bF)(x.O,null,{default:(0,l.k6)((()=>[(0,l.bF)(W.n,{onSubmit:(0,h.D$)(t.submitForm,["prevent"])},{default:(0,l.k6)((()=>[(0,l.bF)(p.W,{modelValue:t.form.name,"onUpdate:modelValue":a[0]||(a[0]=e=>t.form.name=e),label:"Nombre","prepend-icon":"mdi mdi-rename-box",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:t.form.lastName,"onUpdate:modelValue":a[1]||(a[1]=e=>t.form.lastName=e),label:"Apellidos","prepend-icon":"mdi mdi-account-box",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:t.form.licenseNumber,"onUpdate:modelValue":a[2]||(a[2]=e=>t.form.licenseNumber=e),label:"Licencia","prepend-icon":"mdi mdi-card-account-details-outline",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:t.form.username,"onUpdate:modelValue":a[3]||(a[3]=e=>t.form.username=e),label:"Usuario","prepend-icon":"mdi mdi-account-circle-outline",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:t.form.password,"onUpdate:modelValue":a[4]||(a[4]=e=>t.form.password=e),label:"Contraseña",type:"password","prepend-icon":"mdi-key",required:""},null,8,["modelValue"]),(0,l.bF)(_.S,{class:"justify-end"},{default:(0,l.k6)((()=>[(0,l.bF)(w.D,{text:"",onClick:t.closeDialog,color:"#180c24"},{default:(0,l.k6)((()=>[(0,l.eW)("Cancelar")])),_:1},8,["onClick"]),(0,l.bF)(w.D,{type:"submit",color:"#ff8c54"},{default:(0,l.k6)((()=>[(0,l.eW)("Guardar")])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}var $={props:{cisterns:{type:Object,required:!0}},emits:["close"],setup(e,{emit:a}){const r=(0,u.KR)(!0),t=(0,u.KR)({name:"",lastName:"",licenseNumber:"",username:"",password:""});(0,l.wB)((()=>e.cisterns),(e=>{e&&(t.value={...e})}),{immediate:!0});const o=()=>{a("close")},n=async()=>{try{const e={name:t.value.name,lastName:t.value.lastName,licenseNumber:t.value.licenseNumber,username:t.value.username,password:t.value.password},a=g.A.state.token,r=t.value.driverId;await k(a,e,r),A.A.emit("success","¡Operación completada con éxito!"),A.A.emit("masterCreated"),o()}catch(e){A.A.emit("error",`Ups... hubo un error al editar el usuario:  ${e.message}`),console.error("Error al actualizar el cisterns:",e.message)}};return{dialog:r,form:t,closeDialog:o,submitForm:n}}},q=r(1241);const L=(0,q.A)($,[["render",E],["__scopeId","data-v-1ac92ec6"]]);var K=L,R=r(8372),I=r(7572),S=r(3194),j={name:"DataTable",components:{EditDriverForm:K,SuccessAlert:R.A,ErrorAlert:I.A,WarningAlert:S.A},setup(){const e=(0,u.KR)(""),a=(0,u.KR)([]),r=g.A.state.token,t=(0,u.KR)(!1),o=(0,u.KR)(null),n=(0,u.KR)([{key:"name",title:"Nombre"},{key:"lastName",title:"Apellidos"},{key:"licenseNumber",title:"Licencia de Conducir"},{key:"username",title:"Usuario"},{key:"actions",title:"Acciones",sortable:!1}]),s=async()=>{try{const e=await F(r);a.value=e.data.data}catch(e){console.error("Error al obtener los cisterns:",e)}},i=e=>{o.value=e,t.value=!0},d=()=>{t.value=!1};(0,l.sV)((()=>{s(),A.A.on("masterCreated",s)})),(0,l.xo)((()=>{A.A.off("masterCreated",s)}));const m=(0,l.EW)((()=>{if(!e.value)return a.value;const r=e.value.toLowerCase();return a.value.filter((e=>Object.values(e).some((e=>String(e).toLowerCase().includes(r)))))})),c=e=>{const a=e.driverId,r=e.username;A.A.emit("warning",{msg:`¿Estás seguro de que deseas eliminar al usuario ${r}?`,action:async()=>{try{const e=g.A.state.token;await V(e,a),A.A.emit("success","¡Operación completada con éxito!"),s()}catch(e){console.error("Error al eliminar el cisterns:",e)}}})};return{search:e,headers:n,filteredItems:m,openEditForm:i,closeEditForm:d,isEditFormVisible:t,selectCisterns:o,deleteItem:c}}};const O=(0,q.A)(j,[["render",b],["__scopeId","data-v-77032404"]]);var B=O;const X=(0,l.Lk)("span",{class:"text-h5 mp-2 mb-4 text-center"},"Crear Nuevo Conductor",-1);function z(e,a,r,t,o,n){return(0,l.uX)(),(0,l.Wv)(N.p,{modelValue:t.dialog,"onUpdate:modelValue":a[6]||(a[6]=e=>t.dialog=e),"max-width":"600px",persistent:""},{default:(0,l.k6)((()=>[(0,l.bF)(d.J,null,{default:(0,l.k6)((()=>[X,(0,l.bF)(x.O,null,{default:(0,l.k6)((()=>[(0,l.bF)(W.n,{onSubmit:(0,h.D$)(t.submitForm,["prevent"])},{default:(0,l.k6)((()=>[(0,l.bF)(p.W,{modelValue:t.form.name,"onUpdate:modelValue":a[0]||(a[0]=e=>t.form.name=e),label:"Nombre","prepend-icon":"mdi mdi-rename-box",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:t.form.lastName,"onUpdate:modelValue":a[1]||(a[1]=e=>t.form.lastName=e),label:"Apellidos","prepend-icon":"mdi mdi-account-box",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:t.form.document,"onUpdate:modelValue":a[2]||(a[2]=e=>t.form.document=e),label:"Documento","prepend-icon":"mdi mdi-card-account-details-outline",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:t.form.licenseNumber,"onUpdate:modelValue":a[3]||(a[3]=e=>t.form.licenseNumber=e),label:"Licencia","prepend-icon":"mdi mdi-card-account-details-outline",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:t.form.username,"onUpdate:modelValue":a[4]||(a[4]=e=>t.form.username=e),label:"Usuario","prepend-icon":"mdi mdi-account-circle-outline",required:""},null,8,["modelValue"]),(0,l.bF)(p.W,{modelValue:t.form.password,"onUpdate:modelValue":a[5]||(a[5]=e=>t.form.password=e),label:"Contraseña",type:"password","prepend-icon":"mdi-key",required:""},null,8,["modelValue"]),(0,l.bF)(_.S,{class:"justify-end"},{default:(0,l.k6)((()=>[(0,l.bF)(w.D,{text:"",onClick:t.closeDialog,color:"#180c24"},{default:(0,l.k6)((()=>[(0,l.eW)("Cancelar")])),_:1},8,["onClick"]),(0,l.bF)(w.D,{type:"submit",color:"#ff8c54"},{default:(0,l.k6)((()=>[(0,l.eW)("Guardar")])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}var Q={emits:["close"],setup(e,{emit:a}){const r=(0,u.KR)(!0),l=(0,u.KR)({name:"",lastName:"",licenseNumber:"",username:"",password:""}),t=()=>{a("close")},o=async()=>{const e=g.A.state.token,a={name:l.value.name,lastName:l.value.lastName,licenseNumber:l.value.licenseNumber,document:l.value.document,username:l.value.username,password:l.value.password};try{await C(e,a),A.A.emit("success","¡Operación completada con éxito!"),A.A.emit("masterCreated"),t()}catch(r){A.A.emit("error",`Ups... hubo un error al crear el usuario:  ${r.message}`)}};return{dialog:r,form:l,closeDialog:t,submitForm:o}}};const J=(0,q.A)(Q,[["render",z]]);var T=J,G={components:{DataTable:B,CreateDriversForm:T},setup(){const e=(0,u.KR)(!1),a=()=>{e.value=!0},r=()=>{e.value=!1};return{isCreateFormVisible:e,openCreateForm:a,closeCreateForm:r}}};const M=(0,q.A)(G,[["render",i],["__scopeId","data-v-403e9892"]]);var P=M}}]);
//# sourceMappingURL=284.6d537376.js.map