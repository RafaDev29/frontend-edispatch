"use strict";(self["webpackChunkfrontend_ebox_platform"]=self["webpackChunkfrontend_ebox_platform"]||[]).push([[364],{5679:function(e,t,r){r.d(t,{C9:function(){return u},Kq:function(){return s},Y0:function(){return l},uR:function(){return n}});var a=r(1189);const o="http://147.182.161.84:9000/api/v1";function l(e){return a.A.get(`${o}/customers/all`,{headers:{Authorization:`Bearer ${e}`}})}function n(e,t){return a.A.post(`${o}/customers/add`,t,{headers:{Authorization:`Bearer ${e}`}})}function s(e,t,r){return a.A.put(`${o}/customers/update/${r}`,t,{headers:{Authorization:`Bearer ${e}`}})}function u(e,t){return a.A.delete(`${o}/customers/delete/${t}`,{headers:{Authorization:`Bearer ${e}`}})}},6364:function(e,t,r){r.r(t),r.d(t,{default:function(){return P}});var a=r(6768);const o=e=>((0,a.Qi)("data-v-69e56758"),e=e(),(0,a.jt)(),e),l={class:"pt-0 mt-0 pb-10 ml-0 mr-0 min-w-max[100%]"},n={class:"flex justify-between items-center mb-2 bg-gray-50 p-6 rounded-lg shadow-lg"},s=o((()=>(0,a.Lk)("h1",{class:"font-bold lg:text-2xl text-xl text-indigo-900"},[(0,a.Lk)("span",{class:"mdi mdi-tooltip-account"}),(0,a.eW)(" Mantenimiento de Destinatarios")],-1)));function u(e,t,r,o,u,i){const d=(0,a.g2)("DataTable"),m=(0,a.g2)("CreateAddresseesForm");return(0,a.uX)(),(0,a.CE)("div",l,[(0,a.Lk)("div",null,[(0,a.Lk)("div",n,[s,(0,a.Lk)("button",{class:"flex items-center justify-center bg-[#ff8c54] text-white font-semibold px-5 py-2 rounded-lg hover:bg-orange-500 shadow-md",onClick:t[0]||(t[0]=(...e)=>o.openCreateForm&&o.openCreateForm(...e))}," Crear + ")]),(0,a.bF)(d),o.isCreateFormVisible?((0,a.uX)(),(0,a.Wv)(m,{key:0,onClose:o.closeCreateForm},null,8,["onClose"])):(0,a.Q3)("",!0)])])}var i=r(144),d=r(2729),m=r(6329),c=r(9669),p=r(5728);function b(e,t,r,o,l,n){const s=(0,a.g2)("EditAddresseesForm"),u=(0,a.g2)("SuccessAlert"),i=(0,a.g2)("ErrorAlert"),b=(0,a.g2)("WarningAlert");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(d.J,{flat:""},{default:(0,a.k6)((()=>[(0,a.bF)(p.W,{modelValue:o.search,"onUpdate:modelValue":t[0]||(t[0]=e=>o.search=e),label:"Buscar","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":"",density:"compact"},null,8,["modelValue"]),(0,a.bF)(m.Py,{headers:o.headers,items:o.filteredItems,search:o.search},{["item.actions"]:(0,a.k6)((({item:e})=>[(0,a.bF)(c.w,{small:"",class:"mr-2",onClick:t=>o.openEditForm(e)},{default:(0,a.k6)((()=>[(0,a.eW)(" mdi-pencil ")])),_:2},1032,["onClick"]),(0,a.bF)(c.w,{small:"",color:"red",onClick:t=>o.deleteItem(e)},{default:(0,a.k6)((()=>[(0,a.eW)(" mdi-delete ")])),_:2},1032,["onClick"])])),_:2},1032,["headers","items","search"]),o.isEditFormVisible?((0,a.uX)(),(0,a.Wv)(s,{key:0,cisterns:o.selectCisterns,onClose:o.closeEditForm},null,8,["cisterns","onClose"])):(0,a.Q3)("",!0)])),_:1}),(0,a.bF)(u),(0,a.bF)(i),(0,a.bF)(b)],64)}var f=r(1189);const g="http://147.182.161.84:9000/api/v1";function v(e){return f.A.get(`${g}/addressees/all`,{headers:{Authorization:`Bearer ${e}`}})}function h(e,t){return f.A.post(`${g}/addressees/add`,t,{headers:{Authorization:`Bearer ${e}`}})}function k(e,t,r){return console.log(r),f.A.put(`${g}/addressees/update/${r}`,t,{headers:{Authorization:`Bearer ${e}`}})}function A(e,t){return f.A.delete(`${g}/addressees/delete/${t}`,{headers:{Authorization:`Bearer ${e}`}})}var F=r(5129),C=r(6859),V=r(5130),y=r(2807),$=r(1606),x=r(697),_=r(3745),W=r(1772),w=r(1560),E=r(5249);const D=(0,a.Lk)("span",{class:"text-h5"},"Editar Cisterna",-1);function K(e,t,r,o,l,n){return(0,a.uX)(),(0,a.Wv)(W.p,{modelValue:o.dialog,"onUpdate:modelValue":t[5]||(t[5]=e=>o.dialog=e),"max-width":"600px",persistent:""},{default:(0,a.k6)((()=>[(0,a.bF)(d.J,null,{default:(0,a.k6)((()=>[(0,a.bF)($.r,{class:"text-center"},{default:(0,a.k6)((()=>[D])),_:1}),(0,a.bF)(x.O,null,{default:(0,a.k6)((()=>[(0,a.bF)(w.n,{onSubmit:(0,V.D$)(o.submitForm,["prevent"])},{default:(0,a.k6)((()=>[(0,a.bF)(p.W,{modelValue:o.form.name,"onUpdate:modelValue":t[0]||(t[0]=e=>o.form.name=e),label:"Nombre","prepend-icon":"mdi mdi-account-edit",required:""},null,8,["modelValue"]),(0,a.bF)(p.W,{modelValue:o.form.ubigeo,"onUpdate:modelValue":t[1]||(t[1]=e=>o.form.ubigeo=e),label:"Ubigeo","prepend-icon":"mdi-map-marker",required:""},null,8,["modelValue"]),(0,a.bF)(p.W,{modelValue:o.form.phone,"onUpdate:modelValue":t[2]||(t[2]=e=>o.form.phone=e),label:"Teléfono","prepend-icon":"mdi-phone",required:""},null,8,["modelValue"]),(0,a.bF)(p.W,{modelValue:o.form.address,"onUpdate:modelValue":t[3]||(t[3]=e=>o.form.address=e),label:"Dirección","prepend-icon":"mdi-map",required:""},null,8,["modelValue"]),(0,a.bF)(E.d4,{modelValue:o.selectedCustomerName,"onUpdate:modelValue":t[4]||(t[4]=e=>o.selectedCustomerName=e),items:o.customerNames,label:o.form.customerName,"prepend-icon":"mdi mdi-account-group",required:""},null,8,["modelValue","items","label"]),(0,a.bF)(_.S,{class:"justify-end"},{default:(0,a.k6)((()=>[(0,a.bF)(y.D,{text:"",onClick:o.closeDialog,color:"#180c24"},{default:(0,a.k6)((()=>[(0,a.eW)("Cancelar")])),_:1},8,["onClick"]),(0,a.bF)(y.D,{type:"submit",color:"#ff8c54"},{default:(0,a.k6)((()=>[(0,a.eW)("Guardar")])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}var N=r(5679),U={props:{cisterns:{type:Object,required:!0}},emits:["close"],setup(e,{emit:t}){const r=(0,i.KR)(!0),o=(0,i.KR)([]),l=(0,i.KR)([]),n=(0,i.KR)(""),s=(0,i.KR)({name:"",ubigeo:"",phone:"",address:"",customerId:""});(0,a.wB)((()=>e.cisterns),(e=>{e&&(s.value={...e})}),{immediate:!0});const u=()=>{t("close")},d=async()=>{const e=o.value.find((e=>e.name===n.value));if(e){s.value.customerId=e.customerId;try{const e={name:s.value.name,ubigeo:s.value.ubigeo,phone:s.value.phone,address:s.value.address,customerId:s.value.customerId},t=F.A.state.token,r=s.value.addresseeId;await k(t,e,r),C.A.emit("success","¡Operación completada con éxito!"),C.A.emit("masterCreated"),u()}catch(t){C.A.emit("error",`Ups... hubo un error al editar el usuario: ${t.message}`),console.error("Error al actualizar el cisterns:",t.message)}}else C.A.emit("error","No se encontró el cliente seleccionado")},m=async()=>{const e=F.A.state.token;try{const t=await(0,N.Y0)(e);o.value=t.data.data,l.value=o.value.map((e=>e.name))}catch(t){C.A.emit("error",`Error al cargar los clientes: ${t.message}`)}};return(0,a.sV)((()=>{m()})),{dialog:r,form:s,closeDialog:u,submitForm:d,customers:o,customerNames:l,selectedCustomerName:n}}},I=r(1241);const R=(0,I.A)(U,[["render",K]]);var q=R,B=r(8372),z=r(7572),L=r(3194),S={name:"DataTable",components:{EditAddresseesForm:q,SuccessAlert:B.A,ErrorAlert:z.A,WarningAlert:L.A},setup(){const e=(0,i.KR)(""),t=(0,i.KR)([]),r=F.A.state.token,o=(0,i.KR)(!1),l=(0,i.KR)(null),n=(0,i.KR)([{key:"name",title:"Nombre",align:"center"},{key:"ubigeo",title:"Ubigeo",align:"center"},{key:"phone",title:"Teléfono",align:"center"},{key:"address",title:"Dirección",align:"center"},{key:"customerName",title:"Cliente",align:"center"},{key:"actions",title:"Acciones",sortable:!1}]),s=async()=>{try{const e=await v(r);t.value=e.data.data}catch(e){console.error("Error al obtener los cisterns:",e)}},u=e=>{l.value=e,o.value=!0},d=()=>{o.value=!1};(0,a.sV)((()=>{s(),C.A.on("masterCreated",s)})),(0,a.xo)((()=>{C.A.off("masterCreated",s)}));const m=(0,a.EW)((()=>{if(!e.value)return t.value;const r=e.value.toLowerCase();return t.value.filter((e=>Object.values(e).some((e=>String(e).toLowerCase().includes(r)))))})),c=e=>{const t=e.addresseeId,r=e.username;C.A.emit("warning",{msg:`¿Estás seguro de que deseas eliminar al usuario ${r}?`,action:async()=>{try{const e=F.A.state.token;await A(e,t),C.A.emit("success","¡Operación completada con éxito!"),s()}catch(e){console.error("Error al eliminar el cisterns:",e)}}})};return{search:e,headers:n,filteredItems:m,openEditForm:u,closeEditForm:d,isEditFormVisible:o,selectCisterns:l,deleteItem:c}}};const j=(0,I.A)(S,[["render",b]]);var O=j;const T=(0,a.Lk)("span",{class:"text-h5 mp-2 mb-4 text-center"},"Crear Nuevo Destinatario",-1);function X(e,t,r,o,l,n){return(0,a.uX)(),(0,a.Wv)(W.p,{modelValue:o.dialog,"onUpdate:modelValue":t[5]||(t[5]=e=>o.dialog=e),"max-width":"600px",persistent:""},{default:(0,a.k6)((()=>[(0,a.bF)(d.J,null,{default:(0,a.k6)((()=>[T,(0,a.bF)(x.O,null,{default:(0,a.k6)((()=>[(0,a.bF)(w.n,{onSubmit:(0,V.D$)(o.submitForm,["prevent"])},{default:(0,a.k6)((()=>[(0,a.bF)(p.W,{modelValue:o.form.name,"onUpdate:modelValue":t[0]||(t[0]=e=>o.form.name=e),label:"Nombre","prepend-icon":"mdi mdi-account-edit",required:""},null,8,["modelValue"]),(0,a.bF)(p.W,{modelValue:o.form.ubigeo,"onUpdate:modelValue":t[1]||(t[1]=e=>o.form.ubigeo=e),label:"Ubigeo","prepend-icon":"mdi-map-marker",required:""},null,8,["modelValue"]),(0,a.bF)(p.W,{modelValue:o.form.phone,"onUpdate:modelValue":t[2]||(t[2]=e=>o.form.phone=e),label:"Teléfono","prepend-icon":"mdi-phone",required:""},null,8,["modelValue"]),(0,a.bF)(p.W,{modelValue:o.form.address,"onUpdate:modelValue":t[3]||(t[3]=e=>o.form.address=e),label:"Dirección","prepend-icon":"mdi-map",required:""},null,8,["modelValue"]),(0,a.bF)(E.d4,{modelValue:o.selectedCustomerName,"onUpdate:modelValue":t[4]||(t[4]=e=>o.selectedCustomerName=e),items:o.customerNames,label:"Cliente","prepend-icon":"mdi mdi-account-group",required:""},null,8,["modelValue","items"]),(0,a.bF)(_.S,{class:"justify-end"},{default:(0,a.k6)((()=>[(0,a.bF)(y.D,{text:"",onClick:o.closeDialog,color:"#180c24"},{default:(0,a.k6)((()=>[(0,a.eW)("Cancelar")])),_:1},8,["onClick"]),(0,a.bF)(y.D,{type:"submit",color:"#ff8c54"},{default:(0,a.k6)((()=>[(0,a.eW)("Guardar")])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}var J={emits:["close"],setup(e,{emit:t}){const r=(0,i.KR)(!0),o=(0,i.KR)([]),l=(0,i.KR)([]),n=(0,i.KR)(""),s=(0,i.KR)({name:"",ubigeo:"",phone:"",address:"",customerId:""}),u=()=>{t("close")},d=async()=>{const e=F.A.state.token,t=o.value.find((e=>e.name===n.value));if(!t)return void C.A.emit("error","No se encontró el cliente seleccionado");s.value.customerId=t.customerId;const r={name:s.value.name,ubigeo:s.value.ubigeo,phone:s.value.phone,address:s.value.address,customerId:s.value.customerId};try{await h(e,r),C.A.emit("success","¡Operación completada con éxito!"),C.A.emit("masterCreated"),u()}catch(a){C.A.emit("error",`Ups... hubo un error al crear el usuario: ${a.message}`)}},m=async()=>{const e=F.A.state.token;try{const t=await(0,N.Y0)(e);o.value=t.data.data,l.value=o.value.map((e=>e.name))}catch(t){C.A.emit("error",`Error al cargar los clientes: ${t.message}`)}};return(0,a.sV)((()=>{m()})),{dialog:r,form:s,closeDialog:u,submitForm:d,customers:o,customerNames:l,selectedCustomerName:n}}};const Q=(0,I.A)(J,[["render",X]]);var Y=Q,G={components:{DataTable:O,CreateAddresseesForm:Y},setup(){const e=(0,i.KR)(!1),t=()=>{e.value=!0},r=()=>{e.value=!1};return{isCreateFormVisible:e,openCreateForm:t,closeCreateForm:r}}};const M=(0,I.A)(G,[["render",u],["__scopeId","data-v-69e56758"]]);var P=M}}]);
//# sourceMappingURL=364.b9f8629c.js.map